<!DOCTYPE html>
<html>
<head>
    <title>CVE-2020-0601 Tester</title>

    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" type="text/css" href="css/main.css"/>
</head>

<body>
<div class="main-container">
    <header class="header center">
        <nav class="header-wrapper">
            <div class="header-main">
    <img src="ks-logo.png">
            </div>

            <div class="header-links">
                <a class="header-item header-link header-section-link" href="https://research.kudelskisecurity.com/2020/01/15/cve-2020-0601-the-chainoffools-attack-explained-with-poc/">Blog</a>
                <a class="header-item header-link header-section-link" href="https://kudelskisecurity.com/">Website</a>
            </div>
        </nav>
    </header>


    <div class="center main-block">
        <div class="wrapper">
            <div class="content">
                <h2>Proof of Concept using Javascript to load the original certificate</h2>
                <p>The CVE-2020-0601 requires that the original CA certificate is in your certificate cache, this website is using Javascript to load an <a href="https://usertrustecccertificationauthority-ev.comodoca.com/">example page</a> using the correct certificate and will then redirect you to a <a href="https://chainoffools.kudelskisecurity.com">webpage</a> serving a fake, crafted certificate as a test.</p>
                <p> This test is meant to demonstrate the validity of a fake certificate that works for *.kudelskisecurity.com domains and *.microsoft.com domains, as well as for github.com. It could be used as a certificate to do a man-in-the-middle attack.</p> 
                <ul>
                    <li>If you see "Hello World" on the next screen, you're vulnerable to CVE-2020-0601.</li>
                    <li>If you get a certificate error, you're safe!</li>
                </ul> 
                </p>
            </div>
            <div class="content">
                <button type="button" class="btn btn-warning" id="exploitme">Exploit Me</button>
                <script type="application/javascript">
                    const GOOD_URL = "https://usertrustecccertificationauthority-ev.comodoca.com/";
const BAD_URL = "https://chainoffools.kudelskisecurity.com";
document.getElementById('exploitme').onclick = function () {
    fetch(new Request(GOOD_URL),  {mode:'no-cors'})
        .then(function() {
            window.location=BAD_URL;
        })
};
                </script>
                </div>
                <div class="content">
                <p>
                Get more details, including <b>the gory cryptographic details</b>, by reading our write-up on our <a href='https://research.kudelskisecurity.com/?p=13255'>Research Blog</a>!
                </p>
                <p>
                Or get a <b>good high level idea</b> of the threat and how to mitigate it be reading our <a href="https://modernciso.com/2020/01/16/security-advisory-multiple-critical-vulnerabilities-on-windows-systems/">Modern CISO blog post</a> on the topic.
                </p>
                <p>
                Thanks to Scott Arciszewski for the Javascript code :)
                </p>
            </div>
        </div>
    </div>
</div>
</body>
</html>
